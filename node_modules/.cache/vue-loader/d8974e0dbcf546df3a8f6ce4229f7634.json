{"remainingRequest":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\src\\components\\gem-farm\\TreasuryPayout.vue?vue&type=template&id=2c51ba04&ts=true","dependencies":[{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\src\\components\\gem-farm\\TreasuryPayout.vue","mtime":1650820970825},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650821057627},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\babel-loader\\lib\\index.js","mtime":1650821057452},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\ts-loader\\index.js","mtime":1650821095383},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1650821117514},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650821057627},{"path":"C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1650821117514}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQogIDxkaXYgY2xhc3M9Im5lcy1jb250YWluZXIgd2l0aC10aXRsZSI+DQogICAgPHAgY2xhc3M9InRpdGxlIj5UcmVhc3VyeSBQYXlvdXQ8L3A+DQogICAgPGRpdiBjbGFzcz0ibWItNSI+VHJlYXN1cnkgYmFsYW5jZToge3sgYmFsYW5jZSB9fSBsYW1wb3J0czwvZGl2Pg0KDQogICAgPGZvcm0gQHN1Ym1pdC5wcmV2ZW50PSJwYXlvdXRGcm9tVHJlYXN1cnkiPg0KICAgICAgPGRpdiBjbGFzcz0ibmVzLWZpZWxkIG1iLTUiPg0KICAgICAgICA8bGFiZWwgZm9yPSJkZXN0aW5hdGlvbiI+UGF5b3V0IGRlc3RpbmF0aW9uOjwvbGFiZWw+DQogICAgICAgIDxpbnB1dA0KICAgICAgICAgIGlkPSJkZXN0aW5hdGlvbiINCiAgICAgICAgICB0eXBlPSJ0ZXh0Ig0KICAgICAgICAgIHYtbW9kZWw9ImRlc3RpbmF0aW9uIg0KICAgICAgICAgIGNsYXNzPSJuZXMtaW5wdXQiDQogICAgICAgIC8+DQogICAgICA8L2Rpdj4NCiAgICAgIDxkaXYgY2xhc3M9Im5lcy1maWVsZCBtYi01Ij4NCiAgICAgICAgPGxhYmVsIGZvcj0ibGFtcG9ydHMiPkFtb3VudCB0byBwYXkgb3V0IChsYW1wKTo8L2xhYmVsPg0KICAgICAgICA8aW5wdXQgaWQ9ImxhbXBvcnRzIiB0eXBlPSJ0ZXh0IiB2LW1vZGVsPSJsYW1wb3J0cyIgY2xhc3M9Im5lcy1pbnB1dCIgLz4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGJ1dHRvbiBjbGFzcz0ibWItNSBuZXMtYnRuIGlzLXByaW1hcnkiIHR5cGU9InN1Ym1pdCI+UGF5b3V0PC9idXR0b24+DQogICAgPC9mb3JtPg0KICA8L2Rpdj4NCg=="},{"version":3,"sources":["C:\\Users\\ferna\\Desktop\\HiddenStaking\\gem-farm\\app\\gem-farm\\src\\components\\gem-farm\\TreasuryPayout.vue"],"names":[],"mappings":";EACE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACnC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;IAE/D,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACxC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC,CAAC,CAAC;UACH,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACV,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAClB,CAAC;MACH,CAAC,CAAC,CAAC,CAAC,CAAC;MACL,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;MACzE,CAAC,CAAC,CAAC,CAAC,CAAC;MACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACR,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/ferna/Desktop/HiddenStaking/gem-farm/app/gem-farm/src/components/gem-farm/TreasuryPayout.vue","sourceRoot":"","sourcesContent":["<template>\r\n  <div class=\"nes-container with-title\">\r\n    <p class=\"title\">Treasury Payout</p>\r\n    <div class=\"mb-5\">Treasury balance: {{ balance }} lamports</div>\r\n\r\n    <form @submit.prevent=\"payoutFromTreasury\">\r\n      <div class=\"nes-field mb-5\">\r\n        <label for=\"destination\">Payout destination:</label>\r\n        <input\r\n          id=\"destination\"\r\n          type=\"text\"\r\n          v-model=\"destination\"\r\n          class=\"nes-input\"\r\n        />\r\n      </div>\r\n      <div class=\"nes-field mb-5\">\r\n        <label for=\"lamports\">Amount to pay out (lamp):</label>\r\n        <input id=\"lamports\" type=\"text\" v-model=\"lamports\" class=\"nes-input\" />\r\n      </div>\r\n      <button class=\"mb-5 nes-btn is-primary\" type=\"submit\">Payout</button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, onMounted, ref, watch } from 'vue';\r\nimport useWallet from '@/composables/wallet';\r\nimport useCluster from '@/composables/cluster';\r\nimport { initGemFarm } from '@/common/gem-farm';\r\nimport { PublicKey } from '@solana/web3.js';\r\nimport { findFarmTreasuryPDA } from '@gemworks/gem-farm-ts';\r\n\r\nexport default defineComponent({\r\n  props: {\r\n    farm: String,\r\n  },\r\n  setup(props, ctx) {\r\n    const { wallet, getWallet } = useWallet();\r\n    const { cluster, getConnection } = useCluster();\r\n\r\n    let gf: any;\r\n    watch([wallet, cluster], async () => {\r\n      gf = await initGemFarm(getConnection(), getWallet()!);\r\n    });\r\n\r\n    //need an onmounted hook because this component isn't yet mounted when wallet/cluster are set\r\n    onMounted(async () => {\r\n      if (getWallet() && getConnection()) {\r\n        gf = await initGemFarm(getConnection(), getWallet()!);\r\n        await getTresauryBalance();\r\n      }\r\n    });\r\n\r\n    watch(\r\n      () => props.farm,\r\n      async () => {\r\n        await getTresauryBalance();\r\n      }\r\n    );\r\n\r\n    // --------------------------------------- payout\r\n    const destination = ref<string>();\r\n    const lamports = ref<string>();\r\n    const balance = ref<string>();\r\n\r\n    const payoutFromTreasury = async () => {\r\n      await gf.treasuryPayoutWallet(\r\n        new PublicKey(props.farm!),\r\n        new PublicKey(destination.value!),\r\n        lamports.value!\r\n      );\r\n      await getTresauryBalance();\r\n    };\r\n\r\n    const getTresauryBalance = async () => {\r\n      const [treasury] = await findFarmTreasuryPDA(new PublicKey(props.farm!));\r\n      console.log('treasury found:', treasury.toBase58());\r\n      balance.value = await gf.getBalance(treasury);\r\n    };\r\n\r\n    return {\r\n      balance,\r\n      destination,\r\n      lamports,\r\n      payoutFromTreasury,\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style scoped></style>\r\n"]}]}